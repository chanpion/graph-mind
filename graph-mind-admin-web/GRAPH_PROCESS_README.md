# 图数据加工功能说明

## 功能概述

图数据加工模块为图数据库管理系统提供了完整的CSV数据导入功能，支持将外部CSV数据转换为图数据库中的节点和边。

## 功能特性

### 1. 数据导入向导
- 🧭 **五步向导**：选择图 -> 上传文件 -> 数据映射 -> 数据预览 -> 执行导入
- 📁 **CSV支持**：支持标准CSV格式文件导入
- ⚡ **向导导航**：支持步骤前进后退，灵活控制导入流程

### 2. 数据处理能力
- 🔄 **数据映射**：将CSV列映射到图数据库属性
- 👁️ **数据预览**：导入前预览数据确保准确性
- 📊 **进度展示**：实时展示数据导入进度
- 🛡️ **错误处理**：完善的错误处理和提示机制

### 3. 支持的数据类型
- 🟢 **节点数据**：支持导入图节点数据，包括ID、标签、属性等
- 🔵 **边数据**：支持导入图边数据，包括起点、终点、标签、属性等

## 使用指南

### 1. 选择目标图
1. 进入"图数据加工"页面
2. 从下拉列表中选择目标图
3. 选择数据类型（节点数据或边数据）

### 2. 上传CSV文件
1. 点击上传区域或拖拽CSV文件到上传区域
2. 系统自动解析CSV文件并识别表头
3. 支持文件格式验证和大小限制（最大10MB）

### 3. 数据映射配置
1. 系统自动展示CSV文件的列名
2. 为每列选择对应的图数据库字段：
   - 节点数据必须映射ID字段
   - 边数据必须映射起点ID和终点ID字段
   - 其他字段可选，支持映射为属性
3. 系统提供示例数据帮助确认映射关系

### 4. 数据预览
1. 预览前10行数据确认映射结果
2. 检查数据格式是否正确
3. 确认无误后进入下一步

### 5. 执行导入
1. 确认导入配置信息
2. 点击"执行导入"按钮开始导入
3. 查看导入进度和结果

## CSV文件格式要求

### 节点数据CSV格式
```csv
id,name,age,city
1,张三,25,北京
2,李四,30,上海
```

必填字段：
- `id`：节点唯一标识

常用字段：
- `label`：节点标签（类型）
- 其他自定义属性字段

### 边数据CSV格式
```csv
id,source,target,label,weight
1,1,2,friends,0.8
2,2,3,colleagues,0.6
```

必填字段：
- `source`：起点节点ID
- `target`：终点节点ID

常用字段：
- `id`：边唯一标识
- `label`：边标签（类型）
- 其他自定义属性字段

## 映射规则

### 节点映射字段
- `id`：节点唯一标识（必填）
- `label`：节点标签/类型
- `properties`：节点属性（可多个）

### 边映射字段
- `id`：边唯一标识
- `source`：起点节点ID（必填）
- `target`：终点节点ID（必填）
- `label`：边标签/类型
- `properties`：边属性（可多个）

## 注意事项

1. **数据唯一性**：确保节点ID唯一性，避免重复导入
2. **数据格式**：确保CSV文件格式正确，避免解析错误
3. **字段映射**：必填字段必须正确映射
4. **文件大小**：单个文件大小限制为10MB
5. **字符编码**：建议使用UTF-8编码以避免乱码问题

## 技术实现

### 前端技术
- 使用 [PapaParse](https://www.papaparse.com/) 库进行CSV解析
- 基于Element Plus组件库构建用户界面
- 采用Vue 3 Composition API实现组件逻辑

### 后端接口
- `/api/graphs/{graphId}/import/prepare`：准备导入（解析文件结构）
- `/api/graphs/{graphId}/import/execute`：执行导入（实际写入数据）

### 数据处理流程
1. 前端解析CSV文件并展示表头
2. 用户配置字段映射关系
3. 预览数据确认无误
4. 调用后端接口执行导入
5. 展示导入结果和统计信息